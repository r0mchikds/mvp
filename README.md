# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–≤

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äú–∏–∑ –∫–æ—Ä–æ–±–∫–∏‚Äù –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤ e-commerce, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –º–∞–ª—ã–µ –∏ —Å—Ä–µ–¥–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω—ã –±–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π ML-–∫–æ–º–∞–Ω–¥—ã.

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –±–∞–∑–µ **FastAPI**, **SQLModel**, **Streamlit**, **RabbitMQ** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω—É—é CLIP-–ø–æ–¥–æ–±–Ω—É—é –º–æ–¥–µ–ª—å** –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–¥–∞—á –Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤, –∏ –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ.

---

## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –æ–ø–∏—Å–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤;
- **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å CLIP-style** —Å dot-product –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ;
- **FAISS –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤**;
- –ü—Ä–æ—Å—Ç–æ–π API –∏ UI –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∏—Å–∞—Ç—å –∫–æ–¥;
- –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –≤ Docker, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è.

---

## ‚öôÔ∏è –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–æ–º–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å** (User, Item, Interaction, RecommendationTask);
2. **–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL** —á–µ—Ä–µ–∑ SQLModel;
3. **REST API —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π –ø–æ JWT**, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —Ä–æ–ª—è–º;
4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** —á–µ—Ä–µ–∑ RabbitMQ + `ml_worker`;
5. **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π** (–æ–±—É—á–µ–Ω–Ω–∞—è CLIP + InfoNCE + FAISS);
6. **Streamlit-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –ª–∞–π–∫–∏, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è;
7. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ –¥–∞–Ω–Ω—ã—Ö —Å Google Drive** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ;
8. **Docker-—Å–±–æ—Ä–∫–∞ —Å –º–Ω–æ–≥–æ–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**;
9. **–ü–æ–∫—Ä—ã—Ç–∏–µ —é–Ω–∏—Ç- –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏** –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥–µ–ª—å

- **–ö–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É** —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —ç–º–±–µ–¥–¥–∏–Ω–≥, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —á–µ—Ä–µ–∑ CLIP (—Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ);
- **–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö/–ª–∞–π–∫–Ω—É—Ç—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤;
- **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å** –æ–±—É—á–µ–Ω–∞ –Ω–∞ InfoNCE loss: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞—Ä–∞ ‚Äú–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å‚Äì—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä‚Äù –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Äî –æ—Ç–¥–∞–ª—è—é—Ç—Å—è;
- **FAISS-–∏–Ω–¥–µ–∫—Å** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ dot-product;
- **–¢–æ—á–Ω–æ—Å—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π**: `Precision@10 = 0.003`, `MAP@10 = 0.0075`, —á—Ç–æ –≤ 2 —Ä–∞–∑–∞ –≤—ã—à–µ popular-–±–µ–π–∑–ª–∞–π–Ω–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ app/              # FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (backend)
‚îú‚îÄ‚îÄ ml_worker/        # –í–æ—Ä–∫–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ streamlit_ui/     # Streamlit-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ nginx/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx
‚îú‚îÄ‚îÄ docker-compose.yaml
‚îî‚îÄ‚îÄ README.md
```

---

### –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ**, —É–∫–∞–∑–∞–≤:

   ```dotenv
   DATA_FILE_ID=xxx
   MODEL_FILE_ID=xxx
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**

   ```bash
   docker-compose up --build
   ```

3. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:**

   * API-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [http://localhost:8080/docs](http://localhost:8080/docs)
   * –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å Streamlit: [http://localhost:8501](http://localhost:8501)

---

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤:

```bash
docker exec -it recs-api pytest -v
```

–†–∞–±–æ—Ç–∞–µ—Ç —Å `SQLite in-memory` ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ç–µ—Å—Ç–∞–º–∏.

---

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
* –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥—å RabbitMQ;
* –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ML-–º–æ–¥–µ–ª—å—é —á–µ—Ä–µ–∑ `ml_worker`;
* –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–¥–∞—á–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö;
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤;
* –ü—Ä–æ—Å—Ç–æ–π UI –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏;
* –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ FAISS + –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω—É—é –º–æ–¥–µ–ª—å;
* –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é.

---

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

* –í—Å–µ –¥–∞–Ω–Ω—ã–µ (`amazon_items_projected.csv`) –∏ –º–æ–¥–µ–ª—å (`clip_contrastive_best.pth`) –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å Google Drive;
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PyTorch, faiss-cpu –∏ CLIP-—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã);
* –í–æ—Ä–∫–µ—Ä—ã –º–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä `replicas` –≤ `docker-compose`;
* –í –±—É–¥—É—â–µ–º –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ reranker –∏–ª–∏ two-stage pipeline (retrieval + rerank).

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

* **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—â–∏–π MVP**, –ª–æ–∫–∞–ª—å–Ω–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö;
* **–¢–æ—á–Ω–æ—Å—Ç—å –≤—ã—à–µ –±–µ–π–∑–ª–∞–π–Ω–∞ –≤ 2 —Ä–∞–∑–∞**, –¥–∞–∂–µ –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–æ–æ–±—Ä–∞–±–æ—Ç–∫–µ;
* **–ú–æ–¥–µ–ª—å –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ç–µ–º–∞—Ç–∏–∫—É –º–∞–≥–∞–∑–∏–Ω–∞.

---

## TODO

* [ ] –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –¥–≤—É—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (retrieval ‚Üí reranker)
* [ ] CI/CD –ø–∞–π–ø–ª–∞–π–Ω
* [ ] –î–∞—à–±–æ—Ä–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
